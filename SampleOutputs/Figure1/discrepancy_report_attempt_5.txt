Score: 64/100
============================================================

## Discrepancy report (ground-truth top vs generated bottom)

### 1) Series mapping to axes is swapped (major)
- **Ground-truth:**  
  - **Solid line** = *Coefficient for Musical Tolerance* (uses **left y-axis**, negative values).  
  - **Dash-dot line** = *Mean Education of Genre Audience* (uses **right y-axis**, ~12–15).
- **Generated:**  
  - **Solid line** is increasing to ~15-ish and clearly plotted against the **right-axis scale**, i.e., it behaves like **mean education**.  
  - **Dashed/dash-dot line** oscillates around -0.25 to -0.45 and behaves like the **coefficient** series.
- **Impact:** The two series are assigned to the wrong axis/line style.

### 2) Line styles differ
- **Ground-truth:** education series is **dash-dot** (`-.`); coefficient series is **solid** (`-`).
- **Generated:** the “education-looking” series is **solid**, and the “coefficient-looking” series is **dash-dot/dashed**.

### 3) Right-axis tick labeling differs in presence/placement of “13”
- **Ground-truth:** right-axis shows labeled ticks at **12, 13, 14, 15** (13 is clearly labeled).
- **Generated:** right-axis labels appear at **12, 14, 15** (the **13 label is missing/less explicit**).
  - Even if the tick exists, it is not rendered to match the reference (label frequency/locator mismatch).

### 4) Category ordering differs (data ordering / sorting discrepancy)
Comparing the x-axis genre order:
- **Ground-truth order (left→right):**  
  `Latin/Salsa, Jazz, Blues/R&B, Show Tunes, Oldies, Classical, Reggae, Swing, New Age/Space, Opera, Bluegrass, Folk, Easy Listening, Pop/Rock, Rap, Heavy Metal, Country, Gospel`
- **Generated order:**  
  `Latin/Salsa, Jazz, Blues/R&B, Show Tunes, Oldies, Classical, Reggae, Swing, New Age/Space, Opera, Bluegrass, Folk, Easy Listening, Pop/Rock, Rap, Heavy Metal, Country, Gospel`
- **This looks the same by labels**, BUT the **shapes imply the values are not aligned to this order**:
  - In ground-truth, the **education (dash-dot) trends upward strongly** toward Rap/Heavy Metal/Country/Gospel.
  - In generated, the **solid line** does that (so it’s education), while the dash-dot does not—confirming the **series-to-axis swap** rather than pure ordering.
  - Still, verify you didn’t sort one series independently (e.g., sorting by education before plotting) because that would also cause mismatched shapes; the generated coefficient line looks “re-ordered” compared to the ground-truth coefficient jaggedness.

### 5) Annotations/leader lines point to the wrong series (knock-on from swap)
- **Ground-truth:** “Mean Education of Genre Audience” arrow points to the **dash-dot** line; “Coefficient for Musical Tolerance” points to the **solid** line.
- **Generated:** the arrows/text are placed similarly but now point to the **wrong visual series** because styles/axes are swapped.

### 6) Sample mean education horizontal reference line alignment
- Both figures include a dotted horizontal line at about **13** on the right axis, but:
  - **Ground-truth:** it visually matches the right-axis 13 tick and the label “Sample Mean Education”.
  - **Generated:** if the right-axis “13” tick label is missing and/or the line is drawn in left-axis coordinates, the reference line can be subtly misregistered.
  - This is likely caused by drawing the horizontal line on the **wrong Axes object** (left vs right).

---

## Exact fixes (data processing + matplotlib) to match ground-truth

### A) Fix series-to-axis assignment (root cause)
- **Ensure education is plotted on the twin (right) axis and tolerance coefficient on the left axis:**
  - Create axes:  
    - `fig, ax = plt.subplots(...)`  
    - `ax2 = ax.twinx()`
- **Plot tolerance coefficients on `ax` (left):**
  - `ax.plot(x, coef, color='black', linestyle='-', linewidth=2)`
- **Plot mean education on `ax2` (right):**
  - `ax2.plot(x, edu, color='black', linestyle='-.', linewidth=2)`

### B) Prevent accidental independent sorting / misalignment between series
- Build **one** DataFrame keyed by genre and merge all needed columns before plotting:
  - `df = coef_df.merge(edu_df, on='genre', how='inner')`
- Apply a single explicit categorical order (matching the paper) and sort once:
  - `order = [...]  # exact list from ground-truth`
  - `df['genre'] = pd.Categorical(df['genre'], categories=order, ordered=True)`
  - `df = df.sort_values('genre')`
- Use the same `x` index for both series:
  - `x = np.arange(len(df))`
  - `coef = df['coef'].to_numpy()`
  - `edu = df['mean_edu'].to_numpy()`

### C) Match axis ranges and ticks exactly
- **Left y-axis (coefficients):**
  - `ax.set_ylim(-0.5, -0.1)`
  - `ax.set_yticks([-0.5, -0.4, -0.3, -0.2, -0.1])`
  - If you need the “-.1” style formatting (no leading zero), set a formatter:
    - `ax.yaxis.set_major_formatter(FuncFormatter(lambda v, p: f"{v:.1f}".replace("-0.", "-.").replace("0.", ".")))`
- **Right y-axis (education):**
  - `ax2.set_ylim(12, 15)`
  - `ax2.set_yticks([12, 13, 14, 15])`  # force “13” to appear

### D) Draw the sample mean education line in right-axis coordinates
- Compute the mean from the education series used in the plot:
  - `sample_mean = df['mean_edu'].mean()`
- Draw on `ax2` (NOT `ax`):
  - `ax2.axhline(sample_mean, color='black', linestyle=':', linewidth=1)`
- Place the “Sample Mean Education” annotation using `ax2` data coordinates:
  - `ax2.annotate("Sample Mean Education", xy=(...), xytext=(...), arrowprops=...)`

### E) Force line styles to match ground-truth
- Education: `linestyle='-.'`
- Coefficient: `linestyle='-'`
- Use same color for both: `color='black'`
- Use consistent linewidths (paper-like): e.g., `linewidth=2` for series, `1` for reference line.

### F) Ensure x-tick labels and rotation match
- Set ticks/labels explicitly from the ordered DataFrame:
  - `ax.set_xticks(x)`
  - `ax.set_xticklabels(df['genre'], rotation=45, ha='right')`
- Keep the x-axis label text identical:
  - `ax.set_xlabel("Type of Music", fontweight='bold')`

### G) Fix annotation targets after swapping series
- Point “Mean Education of Genre Audience” arrow to the **education line on ax2**:
  - `ax2.annotate(..., xy=(x[i], edu[i]), ...)`
- Point “Coefficient for Musical Tolerance” arrow to the **coef line on ax**:
  - `ax.annotate(..., xy=(x[j], coef[j]), ...)`

### H) If you currently use legend: match inclusion/order (or remove)
- Ground-truth uses **in-plot text labels**, not a legend.
- If you added a legend, remove it:
  - `ax.legend_.remove()` (or don’t call `legend()`)

If you paste your current plotting code (and how you construct the two series), I can point to the exact lines that caused the axis/series swap and the missing “13” tick label.