Score: 62/100
============================================================

## Discrepancy report (Ground-truth Fig. 1 vs. Generated)

### 1) Series mapping is swapped (wrong line associated with each axis)
- **Ground-truth:**  
  - **Solid line** = *Coefficient for Musical Tolerance* (uses **left y-axis**, values around -0.2 to -0.45).  
  - **Dash-dot line** = *Mean Education of Genre Audience* (uses **right y-axis**, values 12–15).
- **Generated:**  
  - **Solid line** is plotted like an education series (monotone increase) and **dash-dot** is plotted like coefficient series (around -0.25 to -0.45).  
- **Impact:** The two lines are effectively assigned to the wrong y-axes / wrong variables.

### 2) Wrong data shapes/trends (likely sorting/aggregation error)
- **Ground-truth coefficient (solid):** jagged, non-monotonic with notable dip around **Bluegrass** and later low near **Country/Gospel**.  
- **Generated coefficient (dash-dot):** jagged but appears to be used for education; and **solid** is near-monotonic increasing—this does not match either ground-truth series.
- **Likely cause:** genres were **sorted by mean education** (or another metric) before plotting, instead of preserving the paper’s fixed genre order.

### 3) X-axis category set / labels differ
- **Ground-truth x labels (order and names):**  
  `Latin/Salsa, Jazz, Blues/R&B, Show Tunes, Oldies, Classical, Reggae, Swing, New Age/Space, Opera, Bluegrass, Folk, Easy Listening, Pop/Rock, Rap, Heavy Metal, Country, Gospel`
- **Generated x labels include mismatches:**  
  - `Classical/Chamber` (ground-truth: **Classical**)  
  - `Swing/Big Band` (ground-truth: **Swing**)  
  - `Pop/Contemporary Rock` (ground-truth: **Pop/Rock**)  
  - `Country/Western` (ground-truth: **Country**)  
  - Order differs substantially from ground-truth (ground-truth places **Reggae** early; generated places it mid-late, etc.)
- **Impact:** Even with correct y-values, the figure won’t match because categories and ordering differ.

### 4) Reference line + annotation placement differ
- **Ground-truth:** dashed horizontal line at **y = 13** on the **right axis** (“Sample Mean Education”) with arrow pointing upward to that dashed line around mid-plot.
- **Generated:** line exists at ~13, but the **annotation/arrow position** differs (location shifts because x-order differs; also text placement differs).

### 5) Axis tick label formatting differs (left axis)
- **Ground-truth left y ticks:** show **no leading zero**: `-.1, -.2, -.3, -.4, -.5`
- **Generated:** appears similar, but if your matplotlib defaults are used you likely have `-0.1` formatting unless explicitly formatted.
- **Impact:** minor but “exact match” requires custom formatter.

### 6) Line styling/weight differences (minor but visible)
- **Ground-truth:** relatively thinner lines; dash-dot for education; solid for coefficient; dashed horizontal mean line is light.
- **Generated:** heavier stroke widths (especially axes and lines), and dash-dot segments look chunkier.

---

## Exact fixes (data processing + matplotlib), step-by-step

### A) Fix the *genre list* and *order* to match ground-truth exactly
- Create a canonical ordered list and reindex your aggregated data to it (do **not** sort by any statistic):
```python
genre_order = [
    "Latin/Salsa","Jazz","Blues/R&B","Show Tunes","Oldies","Classical","Reggae","Swing",
    "New Age/Space","Opera","Bluegrass","Folk","Easy Listening","Pop/Rock",
    "Rap","Heavy Metal","Country","Gospel"
]
df = df[df["genre"].isin(genre_order)].copy()
df["genre"] = pd.Categorical(df["genre"], categories=genre_order, ordered=True)
df = df.sort_values("genre")
```
- If your raw labels differ, **map them** to the ground-truth names before categorizing:
```python
name_map = {
    "Classical/Chamber":"Classical",
    "Swing/Big Band":"Swing",
    "Pop/Contemporary Rock":"Pop/Rock",
    "Country/Western":"Country",
}
df["genre"] = df["genre"].replace(name_map)
```

### B) Compute the two plotted series with the correct transformations (no smoothing)
- **Education series (right axis):** mean years of education among respondents who reported liking each genre.
- **Coefficient series (left axis):** the regression coefficient affecting probability of disliking each genre (must come from your model output; do not re-average it incorrectly).
- Ensure you’re not applying rolling means/interpolation:
```python
edu_mean = df.groupby("genre", observed=True)["education_years"].mean().reindex(genre_order)

# Example: coefficients already computed elsewhere as a per-genre vector/series:
coef = coef_series.reindex(genre_order)   # values around -0.2..-0.45
```

### C) Plot each series on the correct axis (this is currently swapped)
```python
x = np.arange(len(genre_order))

fig, ax = plt.subplots(figsize=(12,4), dpi=200)

# LEFT axis: coefficient (solid)
ax.plot(x, coef.values, color="black", linestyle="-", linewidth=1.6)

ax.set_ylim(-0.5, -0.1)
ax.set_yticks([-0.1,-0.2,-0.3,-0.4,-0.5])
ax.set_ylabel("Coefficients for Musical Tolerance as It Affects\nOne’s Probability of Disliking Each Music Genre",
              fontweight="bold")

# RIGHT axis: mean education (dash-dot)
ax2 = ax.twinx()
ax2.plot(x, edu_mean.values, color="black", linestyle="-.", linewidth=1.6)

ax2.set_ylim(12, 15)
ax2.set_yticks([12,13,14,15])
ax2.set_ylabel("Mean Educational Level of Respondents Who\nReported Liking Each Music Genre",
               fontweight="bold", rotation=270, labelpad=30)
```

### D) Put the horizontal reference line on the **right axis at 13** and match styling
```python
ax2.axhline(13, color="black", linestyle="--", linewidth=1.0, dashes=(2,2))
```

### E) Match x tick labels and rotation
```python
ax.set_xticks(x)
ax.set_xticklabels(genre_order, rotation=45, ha="right")
ax.set_xlabel("Type of Music", fontweight="bold")
```

### F) Match left-axis tick formatting (remove leading zero)
```python
from matplotlib.ticker import FuncFormatter
ax.yaxis.set_major_formatter(FuncFormatter(lambda v, pos: f"{v:.1f}".replace("-0.", "-.").replace("0.", ".")))
```

### G) Recreate the in-plot annotations (positions depend on the fixed order)
- Add the two text labels + arrow leaders approximately as in ground-truth (you will likely need to tweak `xy`/`xytext` after the order is fixed):
```python
ax2.annotate("Mean Education of Genre Audience",
             xy=(2, edu_mean.loc["Blues/R&B"]), xycoords=("data","data"),
             xytext=(1.5, 14.2), textcoords=("data","data"),
             arrowprops=dict(arrowstyle="-", color="black", linewidth=1.0),
             fontsize=12, fontweight="bold")

ax.annotate("Coefficient for Musical Tolerance",
            xy=(2, coef.loc["Blues/R&B"]), xycoords=("data","data"),
            xytext=(2.2, -0.47), textcoords=("data","data"),
            arrowprops=dict(arrowstyle="-", color="black", linewidth=1.0),
            fontsize=12, fontweight="bold")

ax2.annotate("Sample Mean Education",
             xy=(6, 13), xycoords=("data","data"),
             xytext=(6, 12.7), textcoords=("data","data"),
             ha="center",
             arrowprops=dict(arrowstyle="-|>", color="black", linewidth=1.0),
             fontsize=12, fontweight="bold")
```

### H) Ensure no unintended smoothing / interpolation / resampling
- Remove any of the following if present: `rolling()`, `ewm()`, `interp1d`, `resample`, `sort_values(by=...)` (except by the categorical order), or plotting with a continuous x derived from sorting by y.

---

If you paste your current plotting code (and how you compute `coef` and education means), I can mark the exact lines to change and provide a minimal diff.