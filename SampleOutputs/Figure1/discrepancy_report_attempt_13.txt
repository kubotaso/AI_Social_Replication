Score: 58/100
============================================================

## Discrepancy report (GT Figure 1 vs generated)

### 1) Series mapping is swapped (wrong data on each y-axis)
- **GT:**  
  - **Solid line** = *Coefficient for Musical Tolerance* (left y-axis, negative values around -0.25 to -0.45).  
  - **Dash-dot line** = *Mean Education of Genre Audience* (right y-axis, values ~12.7 to ~14.8, increasing to the right).
- **Generated:**  
  - **Solid line** is the increasing curve mapped to the **left** axis (impossible for the tolerance coefficients), while  
  - **Dash-dot line** carries the jagged negative pattern (looks like coefficients) but is mapped to the **right** axis.
- **Impact:** Wrong axis assignment + wrong linestyle-to-series assignment.

### 2) Right-axis education trend direction is wrong
- **GT education (dash-dot):** generally **monotone increasing** from left to right, ending near **~14.8–15** at Gospel.
- **Generated education:** not monotone and includes big drops (e.g., steep dip near Bluegrass) → indicates you’re plotting the wrong series on the right axis (same root cause as #1).

### 3) Coefficient series shape/order differs (data ordering / sorting problem)
- **GT coefficients (solid):** jagged with a pronounced **drop around Bluegrass** and stays lower toward the right (Rap/Heavy Metal/Country/Gospel near ~-0.40 to -0.44).
- **Generated “coefficients” (dash-dot):** pattern doesn’t match GT; also appears shifted/scrambled relative to genres.
- **Likely cause:** genre order in the plotted arrays doesn’t match the x-tick label order used in GT, or you sorted one series but not the other.

### 4) Annotation leader lines point to the wrong line
- **GT:** “Mean Education of Genre Audience” arrow points to the **dash-dot** line; “Coefficient for Musical Tolerance” arrow points to **solid** line.
- **Generated:** those arrows visually point to the **opposite** line because the line identities are swapped.

### 5) Horizontal reference line placement may be slightly off (minor)
- **GT:** dotted “Sample Mean Education” line is at **~13.0** on the right axis.
- **Generated:** looks close, but if you computed it from the wrong column (or after filtering) it may be off.

(Everything else is broadly consistent: dual y-axes present, y-limits appear to match (-0.5..-0.1 and 12..15), no markers, black lines, dash-dot style used, same tick labels text.)

---

## Specific fixes (data processing + matplotlib) to match GT exactly

### A) Fix the axis/linestyle-to-series mapping (core issue)
- **Ensure you plot coefficients on the left axis, education on the right axis:**
  ```python
  fig, ax1 = plt.subplots()
  ax2 = ax1.twinx()

  # left axis: coefficients (solid)
  ax1.plot(x, coef, color='black', lw=2.0, ls='-')

  # right axis: mean education (dash-dot)
  ax2.plot(x, edu_mean, color='black', lw=2.0, ls='-.')
  ```
- **Do not reuse the same variable for both axes** (common bug: `ax.plot(...); ax2.plot(...same y...)` due to a name overwrite).

### B) Lock the genre order to GT and reindex both series to that order (prevents scrambling)
- Define the canonical GT x-order and reindex your aggregated table to it:
  ```python
 genre_order = [
    'Latin/Salsa','Jazz','Blues/R&B','Show Tunes','Oldies','Classical','Reggae',
    'Swing','New Age/Space','Opera','Bluegrass','Folk','Easy Listening',
    'Pop/Rock','Rap','Heavy Metal','Country','Gospel'
]

  df_g = (df.groupby('genre', as_index=False)
            .agg(coef=('tolerance_coef','mean'),
                 edu_mean=('education','mean')))

  df_g['genre'] = pd.Categorical(df_g['genre'], categories=genre_order, ordered=True)
  df_g = df_g.sort_values('genre')

  x = np.arange(len(df_g))
  coef = df_g['coef'].to_numpy()
  edu_mean = df_g['edu_mean'].to_numpy()
  ```
- **Important:** never sort one series independently (e.g., sorting education values to “make it increasing”)—GT’s increase comes from the *genre order*, not from sorting the y-values.

### C) Compute and plot the sample-mean education reference line on the right axis
- Compute from the **full respondent sample** (not genre-means), then draw on `ax2`:
  ```python
  sample_mean_edu = df['education'].mean()
  ax2.axhline(sample_mean_edu, color='black', ls=':', lw=1.2)
  ```
- If GT uses a particular filtered sample, apply the same filter **before** computing `sample_mean_edu`.

### D) Match axis limits and tick formatting exactly
- Left axis range/ticks:
  ```python
  ax1.set_ylim(-0.5, -0.1)
  ax1.set_yticks([-0.5, -0.4, -0.3, -0.2, -0.1])
  ax1.set_yticklabels(['-.5','-.4','-.3','-.2','-.1'])  # to match GT style
  ```
- Right axis range/ticks:
  ```python
  ax2.set_ylim(12, 15)
  ax2.set_yticks([12, 13, 14, 15])
  ```

### E) Match x ticks/labels rotation and placement
```python
ax1.set_xticks(x)
ax1.set_xticklabels(genre_order, rotation=45, ha='right')
ax1.set_xlabel('Type of Music', fontweight='bold')
```

### F) Fix annotations so they point to the correct series (after swapping)
- Point “Mean Education…” to a point on the **dash-dot** line (education), and “Coefficient…” to **solid**:
  ```python
ax2.annotate('Mean Education of Genre Audience',
             xy=(0, edu_mean[0]), xycoords=('data','data'),
             xytext=(2, 14.2), textcoords=('data','data'),
             arrowprops=dict(arrowstyle='-', color='black'),
             fontsize=14, fontweight='bold')

ax1.annotate('Coefficient for Musical Tolerance',
             xy=(2, coef[2]), xycoords=('data','data'),
             xytext=(3, -0.47), textcoords=('data','data'),
             arrowprops=dict(arrowstyle='-', color='black'),
             fontsize=14, fontweight='bold')
  ```
- Place “Sample Mean Education” label with a vertical arrow to the dotted line on `ax2`:
  ```python
ax2.annotate('Sample Mean Education',
             xy=(6, sample_mean_edu), xycoords=('data','data'),
             xytext=(6, 12.7), textcoords=('data','data'),
             ha='center',
             arrowprops=dict(arrowstyle='-|>', color='black'),
             fontsize=14, fontweight='bold')
  ```

### G) Ensure no unintended smoothing/aggregation
- **GT is unsmoothed** line segments through genre means.  
  - If you applied rolling mean / interpolation / spline: remove it.
  - Use plain `groupby().mean()` (or the exact statistic used in the paper) and plot directly.

---

### Minimal “most likely” patch
1) Swap which y array goes to `ax1` vs `ax2`.  
2) Reindex both series to the fixed `genre_order` before plotting.  
3) Draw the sample-mean line on `ax2` using `df['education'].mean()`.

If you paste your current plotting code (and the column names you’re using for coef/education), I can rewrite it into a drop-in corrected snippet.