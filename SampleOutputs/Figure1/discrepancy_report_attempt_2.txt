Score: 62/100
============================================================

## Discrepancy report (ground-truth Fig 1 vs generated)

### 1) Series mapping to axes is swapped (major)
- **Ground truth:**  
  - **Solid line** = *Coefficient for Musical Tolerance* (left y-axis; negative coefficients around -0.25 to -0.45).  
  - **Dash-dot line** = *Mean Education of Genre Audience* (right y-axis; increases ~12.5 → ~14.8).
- **Generated:**  
  - **Solid line** is the *education* trend (monotone up to ~15) but it is visually treated as the dominant series and appears to be plotted against the wrong axis mapping/scale.  
  - **Dash-dot line** carries the *coefficient-like* fluctuations (including a deep dip near “Bluegrass”), i.e., the two series are effectively **reversed** relative to the styles/meaning in the ground truth.

### 2) X-axis category order differs (major)
- **Ground truth order (left→right):**  
  `Latin/Salsa, Jazz, Blues/R&B, Show Tunes, Oldies, Classical, Reggae, Swing, New Age/Space, Opera, Bluegrass, Folk, Easy Listening, Pop/Rock, Rap, Heavy Metal, Country, Gospel`
- **Generated order:**  
  `... Opera, Bluegrass, Folk, Easy Listening, Pop/Rock, Rap, Heavy Metal, Country, Gospel` is present, **but “Rap” is placed after “Pop/Rock”** (OK) while earlier the **relative placement of “New Age/Space” and “Swing” is swapped** (ground truth has Swing then New Age/Space; generated shows Swing then New Age/Space but the *line shapes* indicate the data were likely aligned to a different ordering—peaks/troughs occur under the wrong labels). Net: **your plotted values are not aligned to the ground-truth category sequence.**

### 3) Horizontal reference line (sample mean education) level is wrong (major)
- **Ground truth:** dotted horizontal line at **~13.0** on the **right** education axis (labeled “Sample Mean Education” with arrow).
- **Generated:** dotted horizontal line appears at **~13.1–13.2** (slightly above 13) and the annotation arrow lands at a different vertical level. This indicates the reference value is computed/plotted from different data (or plotted on wrong axis / transformed).

### 4) Annotations and callouts do not match (moderate)
- **Ground truth:** three callouts with specific placements:
  - “Mean Education of Genre Audience” label sits near upper-left with a leader line to the **dash-dot** line.
  - “Coefficient for Musical Tolerance” label near bottom-left with a leader line to the **solid** line.
  - “Sample Mean Education” centered with **upward arrow** to the dotted line.
- **Generated:** text exists but leader lines point to the **wrong series** (consistent with swapped series). Placement/angle differs (notably the top-left callout line).

### 5) Styling differs (minor–moderate)
- **Ground truth:** monochrome, **solid** and **dash-dot**, dotted reference line; relatively thinner strokes; no extra padding.
- **Generated:** heavier lineweights; dash-dot spacing differs; overall typography/spacing differs (e.g., boldness, margins). Ground truth also looks like no top spine emphasis; generated uses modern default spines.

### 6) Y-axis tick formatting mismatch (minor)
- **Ground truth left y-axis:** tick labels shown as **“-.1, -.2, -.3, -.4, -.5”** (no leading zero).
- **Generated:** shows **“-0.1, -0.2, …”** (leading zero present).

---

## Exact fixes: data processing + matplotlib changes

### A) Fix series-to-axis assignment (swap which data is plotted on which axis + styles)
- Ensure:
  - `coef` is plotted on **ax (left)** as **solid**.
  - `mean_edu` is plotted on **ax2 (right)** as **dash-dot**.

```python
ax.plot(x, coef, color='black', lw=2.0, ls='-')          # solid = coefficient (LEFT)
ax2.plot(x, mean_edu, color='black', lw=2.0, ls='-.')    # dash-dot = education (RIGHT)
```

### B) Force the exact category order and align values to it (critical)
- Don’t rely on sorting or dataframe order. Reindex explicitly:

```python
order = [
  "Latin/Salsa","Jazz","Blues/R&B","Show Tunes","Oldies","Classical","Reggae",
  "Swing","New Age/Space","Opera","Bluegrass","Folk","Easy Listening",
  "Pop/Rock","Rap","Heavy Metal","Country","Gospel"
]

df = df.set_index("genre").reindex(order).reset_index()

x = np.arange(len(order))
coef = df["coef_musical_tolerance"].to_numpy()
mean_edu = df["mean_education"].to_numpy()
```

- If your data were aggregated from respondents, compute *mean_education_of_likers* per genre **before** reindexing:
```python
mean_edu = (raw[raw["likes_genre"]==1]
            .groupby("genre")["education_years"].mean()
            .reindex(order))
```

### C) Put the sample mean education line at the correct value and on the right axis
- Compute the **sample mean education** using the same definition as the paper (likely overall respondent mean education, not mean of genre means):

```python
sample_mean_edu = raw["education_years"].mean()
ax2.axhline(sample_mean_edu, color='black', lw=1.0, ls=':')
```

- If the paper uses the mean among *likers* across all genres, replicate that explicitly (don’t guess—match their denominator).

### D) Match axis limits/ticks exactly
- Left axis:
```python
ax.set_ylim(-0.5, -0.1)
ax.set_yticks([-0.1,-0.2,-0.3,-0.4,-0.5])
```

- Right axis:
```python
ax2.set_ylim(12, 15)
ax2.set_yticks([12, 13, 14, 15])
```

### E) Match left tick label formatting (remove leading zero)
```python
from matplotlib.ticker import FuncFormatter

def no_leading_zero(x, pos):
    s = f"{x:.1f}"
    s = s.replace("-0.", "-.").replace("0.", ".")
    return s

ax.yaxis.set_major_formatter(FuncFormatter(no_leading_zero))
```

### F) Match x tick rotation/anchor and label text
```python
ax.set_xticks(x)
ax.set_xticklabels(order, rotation=45, ha='right')
ax.set_xlabel("Type of Music", fontweight='bold')
```

### G) Recreate callouts so they point to the correct series
- After fixing series mapping, anchor annotations to the correct data coordinates:

```python
# label for education (dash-dot on ax2)
ax2.annotate("Mean Education of Genre Audience",
             xy=(2, mean_edu[2]), xycoords=('data','data'),
             xytext=(1.5, 14.2), textcoords=('data','data'),
             arrowprops=dict(arrowstyle='-', color='black'),
             fontweight='bold')

# label for coefficient (solid on ax)
ax.annotate("Coefficient for Musical Tolerance",
            xy=(2, coef[2]), xycoords=('data','data'),
            xytext=(2.0, -0.47), textcoords=('data','data'),
            arrowprops=dict(arrowstyle='-', color='black'),
            fontweight='bold')

# sample mean education annotation (on ax2)
ax2.annotate("Sample Mean Education",
             xy=(6, sample_mean_edu), xycoords=('data','data'),
             xytext=(6, 12.7), textcoords=('data','data'),
             ha='center',
             arrowprops=dict(arrowstyle='-|>', color='black'),
             fontweight='bold')
```

### H) Styling to better match the original
- Use thinner strokes and classic look:
```python
for a in (ax, ax2):
    a.tick_params(direction='out', length=6, width=1)

ax.spines['top'].set_visible(False)   # optional to mimic scanned original look
ax2.spines['top'].set_visible(False)

# Reference line thinner
# Lines slightly thinner than your current
```

---

If you paste your current plotting code + how you compute `mean_education` and `coef`, I can point to the exact lines to change (and confirm whether the “Sample Mean Education” should be computed from all respondents vs genre-likers only).